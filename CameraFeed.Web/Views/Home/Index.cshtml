@model CameraFeed.Web.ViewModels.CameraRequestViewModel

@{
    ViewData["Title"] = "Home Page";
}

<title>Live Webcam Feed</title>
<h1>Live Webcam Feed</h1>

@if (User.Identity?.IsAuthenticated ?? false)
{
    @if (Model.FailList.Any())
    {
        var errorMessage = "The following cameras failed to start: "; @*TODO: build error string in the backend*@
        <div class="alert alert-danger">
            @foreach (var camId in Model.FailList)
            {
                errorMessage += $"{camId} ";
            }
            <strong>@errorMessage</strong>
        </div>
    }

    <div id="camsContainer">
        @foreach (var cameraId in Model.SuccessList)
        {
            @* TODO: appsettings.json *@
            <video-feed camera-id="@cameraId" hub-url="https://localhost:7214/videoHub"></video-feed>
            @* width = "1280" height = "720" *@
            @* <video-feed camera-id="@camId" hub-url="https://pure-current-mastodon.ngrok-free.app/videoHub"></video-feed> *@
        }
    </div>
}
else
{
    <div>
        <p>NOPE</p>
    </div>
}

@section Scripts {
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/7.0.5/signalr.min.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <script src="~/js/videoFeedComponent.js"></script>
}
